package application;

import java.sql.*;


public class DBconnection {
	static Connection connection = null;	//Instanzvariable, auf der die Verbindung gespeichert wird
	static Statement stmt = null;
	static ResultSet result = null;
	
//Verbindung erstellen
	public static boolean connectToMysql(String host, String database, String user, String passwd){
		try{
			Class.forName("com.mysql.jdbc.Driver").newInstance(); //erzeugt neue Instanz vom Treiber, für neue Java Versionen nicht notwendig
			String connectionCommand = "jdbc:mysql://"+host+"/"+database+"?user="+user+"&password="+passwd; //Port nicht notwendig, da Standard (3306) genutzt (Sonst hinter Host)
			connection = DriverManager.getConnection(connectionCommand);
			return true;
		}
		catch (Exception ex){
			return false;
		}
	}
//Verbindung, Statement und ResultSet schließen
	public static void closeConnections() throws SQLException {
		if(result!=null) result.close();
		if(stmt!=null) stmt.close();
		if(connection!=null) connection.close();
	}
	
//DB Zugriff	
	public static ResultSet readDB(String sqlquery) {
		try {
			stmt = connection.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_UPDATABLE);//Ergebnis scrollbar, Query kann DB updaten
			result = stmt.executeQuery(sqlquery);
			return result;
		} 
		catch (SQLException e) {
			e.printStackTrace();
			return null;
		} 			
			
	}

	
}
