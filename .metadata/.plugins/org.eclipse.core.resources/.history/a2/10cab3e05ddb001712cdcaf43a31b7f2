package application;

import java.sql.SQLException;
import java.util.List;
import java.util.Scanner;

import application.Objects.Helper;
import application.Objects.Flugzeug;
import application.Objects.Kunde;
import application.Save.DBconnection;
import application.Save.Sqlquery;

public class Verm {
	static Scanner sc = new Scanner(System.in);
//VERMIETUNG
	// CONSOLE + SQL =========================	
	public static void verm_con_sql(Helper help) throws SQLException  {
		//erzeuge ArrayList mit allen in DB(t_kunden) vorhandenen Einträgen
		List<Kunde> kunden=BuilderDB.getku();
		//erzeuge ArrayList mit allen in DB(t_flugzeuge) vorhandenen Einträgen
		List<Flugzeug> flugzeuge=BuilderDB.getflu();
		
		
		System.out.println("\n----------Vermietung-----------");
		System.out.print("\nGeben Sie die Kundennummer ein: ");
		int idku=sc.nextInt();
		
		//Überprüfung ob Nummer vorhanden
		int i=0;
		while (i==0) {	//Überprüfung ob Kundenummer vorhanden
			for (Kunde kunde: kunden) { //foreach Schleife, für jedes Kundenobjekt in Array Kunden
				if (idku==kunde.getId()) { //wenn Kundenobjekt mit gesuchter ID gefunden wird
					i=1;
					System.out.println("Kundennummer: "+idku);
					System.out.println("Name: "+kunde.getNname()+ ", " +kunde.getVname());
					System.out.println("Adresse: "+kunde.getStr()+" "+kunde.getStrnr()+", "+kunde.getPlz()+" "+kunde.getOrt());

					System.out.print("\nGeben Sie die Flugzeugnummer ein: ");
					int idflu=sc.nextInt();
					i=0;
					while (i==0) {  //Überprüfung ob Flugzeugnummer vorhanden
						for (Flugzeug flugzeug: flugzeuge) {
							if (idflu==flugzeug.getId()) {
								i=1;
								System.out.println("Flugzeugnummer: "+ idflu );
				    		    System.out.println("Modell: "+ flugzeug.getModell());
				    		    System.out.println("Sitzplätze: "+ flugzeug.getSitze());
				    		    
				    		    i=0;
				    		    while (i==0) {//vermieten bestätigen
				    		    	System.out.println("\nWollen sie das Flugzeug "+idflu+" an den Kunden "+idku+" vermieten? (Y/N)");
				    		    	char check=sc.next().toLowerCase().charAt(0);
				    		    	switch (check) {
				    		    		case 'y' : //wird vermietet
				    		    			i=1;
				    		    			//schreibt den Wert von idku in t_flugzeuge an den Datensatz pk_id=idflu
							    		    String verm=Sqlquery.verm(idku, idflu);
							    		    DBconnection.updateDB(verm);
							    		    System.out.println("\nSie haben Flugzeug "+idflu+" an Kunde "+idku+" vermietet.");
				    		    		break;
				    		    		case 'n' : //nicht vermietet
				    		    			i=1;
				    		    			System.out.println("Abgebrochen.");
				    		    		break;
				    		    		default:
				    		    			i=0;
				    		    	}//end of switch
				    		    }//end of while
				    		    break;
							}//end of if
						}//end of for
						if (i==0) {
							System.out.print("\nDie eingegebene Flugzeugnummer existiert nicht. Geben Sie eine andere ein: (0=Beenden)");
							idflu=sc.nextInt();
							
						}//end of if
						if (idflu==0) break; //wenn User 0=beenden gewählt hat
					} // end of while 
					
					break;
				}//end of if
			}//end of for
			if (i==0) {
				System.out.print("\nDie eingegebene Kundenummer existiert nicht. Geben Sie eine andere ein: (0=Beenden)");
				idku=sc.nextInt();
			}//end of if			
			if (idku==0) break; //wenn User 0=beenden gewählt hat
		}//end of while		
		Menu.fortfahrenverm(help);
	}
	// CONSOLE + XML =========================	
	public static void verm_con_xml(Helper help) {
			
	}
	// GUI + SQL =============================	
	public static void verm_gui_sql(Helper help) {
		
	}
	// GUI + XML =============================	
	public static void verm_gui_xml(Helper help) {
			
	}
	
//RÜCKGABE
	// CONSOLE + SQL =========================	
	public static void ruck_con_sql(Helper help) throws SQLException  {
		//erzeuge ArrayList mit allen in DB(t_flugzeuge) vorhandenen Einträgen
		List<Flugzeug> flugzeuge=BuilderDB.getflu();
				
				
		System.out.println("\n----------Rückgabe-----------");
		System.out.print("\nGeben sie die Flugzeugnummer ein: ");
		int idflu=sc.nextInt();
		
		int i=0, idku;
		while (i==0) { 
			for (Flugzeug flugzeug: flugzeuge) {
				if (idflu==flugzeug.getId()) {
					i=1;
					idku=flugzeug.getIdku();
					if (idku==0) System.out.println("\nDas Flugzeug befindet sich im Lager");
					else {
						System.out.println("Flugzeugnummer: "+ idflu );
						System.out.println("Modell: "+ flugzeug.getModell());
						System.out.println("Sitzplätze: "+ flugzeug.getSitze());
						System.out.println("Vermietet an: "+ flugzeug.getIdku());
						while (i==0) {//Rückgabe bestätigen
								System.out.println("\nWollen sie das Flugzeug "+idflu+" vom Kunden "+idku+" zurückgeben? (Y/N)");
			    		    	char check=sc.next().toLowerCase().charAt(0);
			    		    	switch (check) {
			    		    		case 'y' : //wird zurückgegeben
			    		    			i=1;
			    		    			String ruckgabe=Sqlquery.ruckgabe(idflu);
			    						DBconnection.updateDB(ruckgabe);
			    						System.out.println("\nFlugzeug "+idflu+" wurde von Kunde "+flugzeug.getIdku()+" zurückgegeben.");
			    		    		break;
			    		    		case 'n' : //nicht zurückgegeben
			    		    			i=1;
			    		    			System.out.println("Abgebrochen.");
			    		    		break;
			    		    		default:
			    		    			i=0;
			    		    	}//end of switch
			    		    }//end of while	
					}//end of else
		   		    break;
				}//end of if
			}//end of for
			if (i==0) {
				System.out.print("\nDie eingegebene Flugzeugnummer existiert nicht. Geben Sie eine andere ein: (0=Beenden)");
				idflu=sc.nextInt();
			}//end of if
			if (idflu==0) break; //wenn User 0=beenden gewählt hat
		} // end of while 
		Menu.fortfahrenverm(help);			
	}
	// CONSOLE + XML =========================	
	public static void ruck_con_xml(Helper help) {
			
	}
	// GUI + SQL =============================	
	public static void ruck_gui_sql(Helper help) {
			
	}
	// GUI + XML =============================	
		public static void ruck_gui_xml(Helper help) {
			
	}

//SUCHE (KNR)
	// CONSOLE + SQL =========================	
	public static void sk_con_sql(Helper help) throws SQLException  {
		//erzeuge ArrayList mit allen in DB(t_kunden) vorhandenen Einträgen
		List<Kunde> kunden=BuilderDB.getku();
		//erzeuge ArrayList mit allen in DB(t_flugzeuge) vorhandenen Einträgen
		List<Flugzeug> flugzeuge=BuilderDB.getflu();
		
		
		System.out.println("\n----------Suche (Kundennummer)-----------");
		System.out.print("\nGeben Sie die Kundennummer ein:");
		int idku=sc.nextInt();
		int i=0;
		while (i==0) {	
			for (Kunde kunde: kunden) { //foreach Schleife, für jedes Kundenobjekt in Array Kunden
				if (idku==kunde.getId()) { //wenn Kundenobjekt mit gesuchter ID gefunden wird
					i=1;
					System.out.println("\nFolgende Flugzeuge wurden an "+kunde.getNname()+", "+kunde.getVname()+" (#"+kunde.getId()+") vermietet:");
					for (Flugzeug flugzeug: flugzeuge) {
						if (idku==flugzeug.getIdku()) {
							i=1;
							System.out.println("Flugzeugnummer: "+ flugzeug.getId() );
			    		    System.out.println("Modell: "+ flugzeug.getModell());
			    		    System.out.println("Sitzplätze: "+ flugzeug.getSitze());
			    		    break;
						}//end of if
					}//end of for
					break;
				}//end of if
			}//end of for
			if (i==0) {
				System.out.print("\nDie eingegebene Kundenummer existiert nicht. Geben Sie eine andere ein: (0=Beenden)");
				idku=sc.nextInt();
			}//end of if			
			if (idku==0) break; //wenn User 0=beenden gewählt hat
		}//end of while
		Menu.fortfahrenverm(help);
	}
	// CONSOLE + XML =========================	
	public static void sk_con_xml(Helper help) {
			
	}
	// GUI + SQL =============================	
	public static void sk_gui_sql(Helper help) {
			
	}
	// GUI + XML =============================	
	public static void sk_gui_xml(Helper help) {
				
	}
		
//SUCHE (FNR)
	// CONSOLE + SQL =========================	
	public static void sf_con_sql(Helper help) throws SQLException  {
		//erzeuge ArrayList mit allen in DB(t_kunden) vorhandenen Einträgen
		List<Kunde> kunden=BuilderDB.getku();
		//erzeuge ArrayList mit allen in DB(t_flugzeuge) vorhandenen Einträgen
		List<Flugzeug> flugzeuge=BuilderDB.getflu();
			
		System.out.println("\n----------Suche (Flugzeugnummer)-----------");
		System.out.print("\nGeben Sie die Flugzeugnummer ein:");
		int idflu=sc.nextInt();
		int i=0;
		//Überprüfung ob Flugzeugnummer vorhanden
		while (i==0) { 
			for (Flugzeug flugzeug: flugzeuge) {
				if (idflu==flugzeug.getId()) {
					i=1;
					int idku=flugzeug.getIdku();
					for (Kunde kunde: kunden) { //foreach Schleife, für jedes Kundenobjekt in Array Kunden
						if (idku==kunde.getId()) { //wenn Kundenobjekt mit gesuchter ID gefunden wird
							System.out.println("\nDas Flugzeug "+flugzeug.getModell()+" (#"+flugzeug.getId()+") wurde an "+kunde.getNname()+", "+kunde.getVname()+" (#"+kunde.getId()+") vermietet");
						}//end of if
						else {
							System.out.println("\nDas Flugzeug "+flugzeug.getModell()+" (#"+flugzeug.getId()+") ist im Lager");
						}//end of else
					}//end of for
	    		    break;
				}//end of if
			}//end of for
			if (i==0) {
				System.out.print("\nDie eingegebene Flugzeugnummer existiert nicht. Geben Sie eine andere ein: (0=Beenden)");
				idflu=sc.nextInt();
			}//end of if
			if (idflu==0) break; //wenn User 0=beenden gewählt hat
		} // end of while 
		Menu.fortfahrenverm(help);	
	}
	// CONSOLE + XML =========================	
	public static void sf_con_xml(Helper help) {
				
	}
	// GUI + SQL =============================	
	public static void sf_gui_sql(Helper help) {
				
	}
	// GUI + XML =============================	
	public static void sf_gui_xml(Helper help) {
				
	}
}
