package application;


import java.sql.SQLException;
import java.util.List;
import java.util.Scanner;

public class IO_kuverw {
	static Scanner sc = new Scanner(System.in);

	//====Neues Objekt====	
		public static void neuobj() throws SQLException {
			//Eingaben
			System.out.println("\n----------Neuen Kunden hinzufügen-----------");                                            //--Eingabe Beginn
		    System.out.print("\nVorname: ");
		    String vname=sc.next();
		    System.out.print("\nNachname: ");
		    String nname=sc.next();
		    System.out.print("\n---Adresse--- ");
		    System.out.print("\nStraße: ");
		    String str=sc.next();
		    System.out.print("\nNummer: ");
		    int strnr=sc.nextInt();
		    System.out.print("\nPLZ: ");
		    int plz=sc.nextInt();
		    System.out.print("\nOrt: ");
		    String ort=sc.next();
		    //nächste freie ID wird aus DB geladen
		    String sqlquery = Sqlquery.getKunden();
		    List<O_Kunde> kunden=DBconnection.showDBku(sqlquery);
		    int id=1;
		    try {
		    	id=kunden.get(kunden.size()-1).getId()+1;
		    }	    	
		    catch (ArrayIndexOutOfBoundsException e) {
		    	System.out.println("\nDies ist der erste Datensatz, ID=1");
		    }
		    catch (NullPointerException e) {
		    	System.out.println("\nNullPointerException");
		    }
		
		    //Kunden Objekt erstellen
		    O_Kunde kunde = new O_Kunde(id, plz, strnr, vname, nname, str, ort);
		    String newKunde = Sqlquery.newKunde(id, nname, vname, str, strnr, plz, ort);
		    DBconnection.updateDB(newKunde);
		    
		    //Ausgabe Check
		    System.out.println("\nSie haben folgenden Kunden hinzugefügt:");                                                     //--Ausgabe Beginn
		    System.out.println("Kundennummer: "+kunde.getId());
		    System.out.println("Name: "+kunde.getNname()+ ", " +kunde.getVname());
		    System.out.println("Adresse: "+kunde.getStr()+" "+kunde.getStrnr()+", "+kunde.getPlz()+" "+kunde.getOrt()); 
		    IO_MainMenu.fortfahren();
		}//end of method neuobj
		
	//====Objekt löschen	
		public static void delobj() throws SQLException {
			System.out.println("\n----------Kunde entfernen-----------");                                            //--Eingabe Beginn
		    int i=0, id = 0, ende = 0;
			System.out.print("\nGeben Sie die Kundennummer ein: ");
			id=sc.nextInt();
			//Prüfung ob ID vergeben
			while (i==0) {
				String sqlquery = Sqlquery.getKunden();
			    List<O_Kunde> kunden=DBconnection.showDBku(sqlquery);
				for (O_Kunde kunde: kunden) { //foreach Schleife, für jedes Kundenobjekt in Array Kunden
					if (id==kunde.getId())  i=1;
				}
				if (i==0) System.out.print("\nDie eingegebene Kundenummer existiert nicht. Geben Sie eine andere ein: (0=Beenden)");
				id=sc.nextInt();
				if (id==0) {ende=1;break;}
			}	
			//Überprüfung ob User 0=beenden ausgewählt hat
			if (ende==1) IO_MainMenu.fortfahren();
			else {
				//Löschen bestätigen
				i=0;
				while (i==0) {
					System.out.println("Löschen bestätigen (Y/N)");
					char del=sc.next().toLowerCase().charAt(0);
					switch (del) {
					case 'y' : //wird gelöscht
						i=1;
						String delete = Sqlquery.delKunde(id);
						DBconnection.updateDB(delete);
						System.out.println("Erfolgreich gelöscht");
						break;
					case 'n' : //wird nicht gelöscht
						i=1;
						System.out.println("Löschen beendet");
						break;
					default:
						i=0;
					}//end of switch
				}//end of while
				IO_MainMenu.fortfahren();
			}//end of else
		}//end of method delobj
		
	//===Objekt anzeigen
		public static void showobj(String[][] flugzeug, String[][] kunde) throws SQLException {
			 int i=0, ende=0;
			 System.out.println("\n----------Anzeigen eines Kunden-----------");
			 System.out.print("\nGeben Sie die Kundennummer ein:");
			 int id=sc.nextInt();
			 while (i==0) {
					String sqlquery = Sqlquery.getKunden();
				    List<O_Kunde> kunden=DBconnection.showDBku(sqlquery);
					for (O_Kunde kunde1: kunden) { //foreach Schleife, für jedes Kundenobjekt in Array Kunden
						if (id==kunde1.getId())  i=1;
					}
					if (i==0) System.out.print("\nDie eingegebene Kundenummer existiert nicht. Geben Sie eine andere ein: (0=Beenden)");
					id=sc.nextInt();
					if (id==0) {ende=1;break;}
				}	
				//Überprüfung ob User 0=beenden ausgewählt hat
				if (ende==1) IO_MainMenu.fortfahren();
			 
			 
			 
			 
			 if ((kunde[id][0]!=null)&&(kunde[id][1]!=null)) {
				 System.out.println("Kundennummer: "+id);
				 System.out.println("Name: "+kunde[id][0]+ ", " +kunde[id][1]);
				 System.out.println("Adresse: "+kunde[id][2]+" "+kunde[id][3]+", "+kunde[id][4]+" "+kunde[id][5]);
			 } // end of if
			 else System.out.println("\nEs gibt kein Kunden mit der Nummer "+id+"\n");	
			 IO_MainMenu.fortfahren();
		}//end of method showobj
		
/*		public static void showall(String[][] flugzeug, String[][] kunde) {
			System.out.println("\n----------Anzeigen aller Kunden-----------");
		    for (int i=1; i<=500 ;i++ ) {
		      if ((kunde[i][0]!=null)&&(kunde[i][1]!=null)) {
		    	  System.out.println("Kundennummer: "+ i);
				  System.out.println("Name: "+kunde[i][0]+ ", " +kunde[i][1]);
				  System.out.println("Adresse: "+kunde[i][2]+" "+kunde[i][3]+", "+kunde[i][4]+" "+kunde[i][5]); 
		      } // end of if
		    } // end of for
		    IO_MainMenu.fortfahren(flugzeug, kunde);
	}//end of method showall
*/
}
